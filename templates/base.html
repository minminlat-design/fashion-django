{% load static %}

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">

<head>
    <meta charset="utf-8">
    <title>{% block title %}Home{% endblock title %}</title>

    <meta name="author" content="themesflat.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- font -->
    <link rel="stylesheet" href="{% static 'fonts/fonts.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/font-icons.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/drift-basic.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/photoswipe.css' %}">
    <link rel="stylesheet" href="{% static 'css/swiper-bundle.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/mycss.css' %}" />

    <!-- Favicon and Touch Icons  -->
    <link rel="shortcut icon" href="{% static 'images/logo/favicon.png' %}">
    <link rel="apple-touch-icon-precomposed" href="{% static 'images/logo/favicon.png' %}">

    <!-- Optional CSS -->
<style>
  input.variation-radio:checked + img,
  input.variation-radio:checked + div.bg-secondary {
    outline: 3px solid #0d6efd;
    outline-offset: 2px;
    border-radius: 6px;
  }

  .modal-body img {
    object-fit: contain;
    max-height: 80vh;
  }

  #variationModalCaption {
    font-size: 1rem;
    text-transform: capitalize;
  }

  
  input[type="radio"]:checked + label img {
    border: 3px solid #007bff;
  }



  
</style>



</head>

<body class="preload-wrapper popup-loader">


    <!-- header -->
    {% include "includes/navbar.html" %}
    <!-- end header -->

    
    {% block content %}
    
    {% endblock content %}


    <!-- footer -->
    {% include "includes/footer.html" %}
    <!-- footer -->


    <!-- Javascript -->
    <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/swiper-bundle.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/carousel.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/bootstrap-select.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/drift.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lazysize.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/count-down.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/wow.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/multiple-modal.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/nouislider.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/shop.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/main.js' %}"></script>
    

    <script type="module" src="{% static 'js/model-viewer.min.js' %}"></script>
    <script type="module" src="{% static 'js/zoom.js' %}"></script>


<script>
document.addEventListener("DOMContentLoaded", function () {
  const setItemsSelect = document.getElementById("set-items");
  const customizeToggle = document.getElementById("customize-toggle");
  const customizationFields = document.getElementById("customization-fields");
  const customizationGroups = document.querySelectorAll(".customization-group");

  const monogramCheckbox = document.getElementById("enable-jacket-monogram");
  const monogramFields = document.getElementById("jacket-monogram-fields");

  const vestCheckbox = document.getElementById("enable-vest-customization");
  const vestFields = document.getElementById("vest-customization-fields");

  // Shirt checkbox and fields
  const shirtCheckbox = document.getElementById("enable-shirt-customization");
  const shirtFields = document.getElementById("shirt-customization-fields");

  const totalPriceEl = document.getElementById("total-price");

  // Use discounted_price if available, otherwise use product.price
  const basePrice = parseFloat("{% if product.discounted_price %}{{ product.discounted_price|floatformat:2 }}{% else %}{{ product.price|floatformat:2 }}{% endif %}");

  const MONOGRAM_PRICE = parseFloat("{{ monogram_price }}");
  
  const VEST_PRICE = parseFloat("{{ vest_price }}");
  const SHIRT_PRICE = parseFloat("{{ shirt_price }}");

  const shirtMonogramCheckbox = document.getElementById("enable-shirt-monogram");
  const shirtMonogramFields = document.getElementById("shirt-monogram-fields");


  let currentTarget = "";


  if (shirtMonogramCheckbox && shirtMonogramFields) {
  shirtMonogramCheckbox.addEventListener("change", () => {
    shirtMonogramFields.style.display = shirtMonogramCheckbox.checked ? "block" : "none";
    calculateTotal();
  });
}


  // Monogram checkbox toggle
  if (monogramCheckbox && monogramFields) {
    monogramCheckbox.addEventListener("change", () => {
      monogramFields.style.display = monogramCheckbox.checked ? "block" : "none";
      calculateTotal();
    });
  }

  // Vest checkbox toggle
  if (vestCheckbox && vestFields) {
    vestCheckbox.addEventListener("change", () => {
      vestFields.style.display = vestCheckbox.checked ? "block" : "none";
      calculateTotal();
    });
  }

  // Shirt checkbox toggle
  if (shirtCheckbox && shirtFields) {
    shirtCheckbox.addEventListener("change", () => {
      shirtFields.style.display = shirtCheckbox.checked ? "block" : "none";
      calculateTotal();
    });
  }

  // Toggle main customization panel
  customizeToggle.addEventListener("click", function () {
    const isHidden = customizationFields.style.display === "none";
    customizationFields.style.display = isHidden ? "block" : "none";
    updateCustomizationGroups();
    calculateTotal();
  });

  // Show correct customization group based on selected set item
  function updateCustomizationGroups() {
    const selectedSet = setItemsSelect.options[setItemsSelect.selectedIndex];
    currentTarget = selectedSet.dataset.target;

    customizationGroups.forEach((group) => {
      group.style.display = group.dataset.target === currentTarget ? "block" : "none";
    });

    if (currentTarget === "jacket") {
      monogramFields.style.display = monogramCheckbox.checked ? "block" : "none";
    } else {
      monogramFields.style.display = "none";
      if(monogramCheckbox) monogramCheckbox.checked = false;
    }
  }

  // Calculate total price
  function calculateTotal() {
    let total = basePrice;


    // Shirt monogram prices
    if (currentTarget === "shirt" && shirtMonogramCheckbox && shirtMonogramCheckbox.checked) {
      total += MONOGRAM_PRICE;

      const monogramRadios = shirtMonogramFields.querySelectorAll('input[type="radio"]:checked');
      monogramRadios.forEach((radio) => {
        total += parseFloat(radio.dataset.price || 0);
      });
    }


    // Add set item price
    const selectedSet = setItemsSelect.options[setItemsSelect.selectedIndex];
    total += parseFloat(selectedSet.dataset.price || 0);

    // Add customization prices only if customization panel is visible
    if (customizationFields.style.display !== "none") {
      const activeGroup = document.querySelector(`.customization-group[data-target="${currentTarget}"]`);
      if (activeGroup) {
        const checkedRadios = activeGroup.querySelectorAll('input[type="radio"]:checked');
        checkedRadios.forEach((radio) => {
          total += parseFloat(radio.dataset.price || 0);
        });
      }

      // Monogram prices (jacket only)
      if (currentTarget === "jacket" && monogramCheckbox && monogramCheckbox.checked) {
        total += MONOGRAM_PRICE;
        const monogramRadios = monogramFields.querySelectorAll('input[type="radio"]:checked');
        monogramRadios.forEach((radio) => {
          total += parseFloat(radio.dataset.price || 0);
        });
      }
    }

    // Add vest price if checked (always)
    if (vestCheckbox && vestCheckbox.checked) {
      total += VEST_PRICE;
    }

    // Add shirt price if checked (always)
    if (shirtCheckbox && shirtCheckbox.checked) {
      total += SHIRT_PRICE;
    }

    totalPriceEl.textContent = total.toFixed(2);
  }

  // Set item dropdown change
  setItemsSelect.addEventListener("change", function () {
    updateCustomizationGroups();
    calculateTotal();
  });

  // Customization radio buttons change
  document.querySelectorAll('#customization-fields input[type="radio"]').forEach((radio) => {
    radio.addEventListener("change", calculateTotal);
  });

  // Initialize on page load
  updateCustomizationGroups();
  calculateTotal();
});




</script>




<script>
  const form = document.querySelector("form");  // if there is only one form on the page


if (form) {
  form.addEventListener("submit", function(e) {
    console.log("Form submitted");
  });
} else {
  console.warn("Form element not found!");
}

</script>


    

</body>

</html>